in =: '1'&=;._2 (1!:1) 3

NB. Find most common bit
u =: {{ <. 0.5 + (+/ % #) y }}
v =: -. @: u

p1 =: (#. * ([: #. -.)) u in

q =: }."1 @: (#~ ([: ([ = u) {."1))
r =: $:@:q ` ({:"1) @. (# = 1:) (,. #.) in

s =: }."1 @: (#~ ([: ([ = v) {."1))
t =: $:@:s ` ({:"1) @. (# = 1:) (,. #.) in

p2 =: r * t

(p1;p2) (1!:2) 2
